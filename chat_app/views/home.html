<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="container text-center">
        <h2 class="my-3">Welcome, <span id="userLabel"></span>!</h2>
        
        <hr />
        <h4>Join a Public Room</h4>
        <div class="row">
            <div class="col-md-6 mx-auto">
                <select id="roomSelect" class="form-select mb-3">
                    <option value="devops">DevOps</option>
                    <option value="cloudcomputing">Cloud Computing</option>
                    <option value="covid19">Covid19</option>
                    <option value="sports">Sports</option>
                    <option value="nodejs">NodeJS</option>
                </select>
                <button id="joinRoomBtn" class="btn btn-primary w-100">Join Room</button>
            </div>
        </div>

        <hr />
        <h4>Start a Private Chat</h4>
        <div class="row">
            <div class="col-md-6 mx-auto">
                <input type="text" id="buddyNameInput" class="form-control" placeholder="Friend's username">
                <button id="startPrivateBtn" class="btn btn-warning w-100 mt-2">Private Chat</button>
            </div>
        </div>
        
        <hr />
        <button id="logoutBtn" class="btn btn-danger w-100">Logout</button>
    </div>

    <script>
        const username = localStorage.getItem("username");
        if (!username) {
            window.location.href = "/login.html";
        } else {
            document.getElementById("userLabel").textContent = username;
        }

        document.getElementById("joinRoomBtn").addEventListener("click", () => {
            const room = document.getElementById("roomSelect").value;
            localStorage.setItem("room", room);
            window.location.href = "/chat.html";
        });

        document.getElementById("startPrivateBtn").addEventListener("click", () => {
            const buddy = document.getElementById("buddyNameInput").value.trim();
            if (!buddy) {
                return alert("Please enter a username!");
            }
            localStorage.setItem("privateBuddy", buddy);
            window.location.href = "/privateChat.html";
        });

        document.getElementById("logoutBtn").addEventListener("click", () => {
            localStorage.removeItem("username");
            localStorage.removeItem("room");
            localStorage.removeItem("privateBuddy");
            window.location.href = "/login.html";
        });
    </script>
</body>
</html>
